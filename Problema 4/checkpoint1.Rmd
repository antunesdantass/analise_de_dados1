---
title: "Problema 4 - Checkpoint 1"
output: html_notebook
---

```{r, include=FALSE}
library(dplyr, warn.conflicts = F)
library(readr)
dados = read_csv("github-users-committing-filetypes.csv")
```


O GitHub é uma plataforma online de código-fonte e controle de versão. Nela inúmeros programadores disponibilizam seus projetos de código aberto para que toda a comunidade possa utilizá-los e melhorá-los.

Como deve-se imaginar, esse serviço contém uma grande quantidade de projetos, escrito em diferentes linguagens de programação. Neste trabalho, vamos analisar um pouco o comportamento dos usuários do GitHub. Para isso, foi colhido uma amostra dos dados. Como a quantidade de informação é muito grande, optamos por pegar uma quantidade reduzida para facilitar a análise.

Cada observação no dataset representa o dado de um conjunto de commits em determinado dia do ano. A observação é composta por: Linguagem de Programação (facilmente podemos inferir através da extensão do arquivo), data e número de usuários que deram commit naquela linguagem naquele dia.

As linguagens de programação disponíveis no dataset são:

```{r}
unique(dados$file_extension) %>%
  sort()
```

Como é possível ver, algumas extensões disponíveis no dataset não são de programação. Na nossa análise, levaremos em consideração duas linguagens de programação para responder as seguintes perguntas:
  1 - Para cada uma delas, há uma diferença significativa na sua popularidade durante a semana e durante o fim de semana? Essa diferença é grande?
  2 - Existe uma diferença significativa entre as duas linguagens na sua variação de popularidade nos finais de semana?
  
As linguagens escolhidas são: Java e Python.

```{r}
pyva = dados %>%
  filter(file_extension %in% c("java", "py"))

pyva$date <- paste(pyva$month_day,pyva$the_month, pyva$the_year, sep = "-")

pyva = pyva %>%
  mutate(weekday = weekdays(as.Date(date,'%d-%m-%Y')))
```

Como nossos dados são apenas uma amostra do universo total de commits no github, vamos utilizar uma técnica chamada bootstrapping. O bootstrapping é um método de reamostragem utilizado para aproximar distribuição na amostra de um levantamento estatístico.

```{r}
amostra = sample(pyva$users, 200)

repeticoes = 4000 # pelo menos 2000, mas mais não faz mal.

exp_com_bootstrap <- function(x){
  boot_x <- sample(x, size = NROW(x), replace = TRUE) # aqui é o bootstrap
  return(median(boot_x))
}

# Agora o input das reamostragens é a amostra!
experimentos = data_frame(i = 1:repeticoes) %>% 
  rowwise() %>% 
  mutate(media_exp = exp_com_bootstrap(amostra)) # <- Aqui!

ggplot(experimentos, aes(x = media_exp)) + 
  geom_histogram(binwidth = 1, colour = "darkorange", fill = "white")
summary(experimentos)

# IC com 90%: 
alpha = .1
quantile(experimentos$media_exp, 
         probs = c(.05, .95))
ci = quantile(experimentos$media_exp, probs = c(alpha/2, 1 - alpha/2))

ggplot(experimentos, aes(x = media_exp)) + 
  geom_histogram(binwidth = 1, colour = "darkorange", fill = "white") + 
  geom_vline(aes(xintercept = ci[[1]]), colour = "blue") + 
  geom_vline(aes(xintercept = ci[[2]]), colour = "blue") + 
  geom_vline(aes(xintercept = mean(pyva$users)), colour = "green")

# IC com 95%: 
alpha = .05
ci = quantile(experimentos$media_exp, 
              probs = c(alpha/2, 1 - alpha/2))

```

